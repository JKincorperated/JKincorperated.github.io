<!DOCTYPE html>
<html>
<head>
<title>IPvD-V1-Specifcation.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="ipvd-protocol-specification-version-1-revision-3">IPvD Protocol Specification Version 1 (Revision 3)</h1>
<p>All packets must be in the order they appear in on the list.</p>
<h2 id="addresses">Addresses</h2>
<h3 id="to-obtain-an-address">To obtain an address</h3>
<ul>
<li>Generate a ECC-384 Keypair</li>
<li>Save the public key.</li>
<li>Hash your public key with the SHA-512 algorithm</li>
<li>Encode the hash in Base32</li>
<li>Add Version Specifier</li>
</ul>
<h3 id="address-format">Address Format</h3>
<ul>
<li>Address Must contain &quot;v1-&quot; at start.</li>
<li>Last Section of address should be the SHA-512 hash of your Public Key represented in base32 format.</li>
</ul>
<p>Example:</p>
<pre class="hljs"><code><div>v1-266SL62DWSZS5TFOIBMLFJXAOMSBUA4WHZQPRB7BINLWRLEIUS3BTX7RDVD2PEKJY6KSCUT3A4PRS5H7O553JBPB6HDOA3TASUJ63BY=
</div></code></pre>
<h2 id="packet-structure">Packet Structure</h2>
<p>All IPvD packets must contain (In this order):</p>
<ul>
<li>Sender Address Size (uint16)</li>
<li>Sender Address (utf-8)</li>
<li>Receipient Address Size (uint16)</li>
<li>Receipient Address (utf-8)</li>
<li>Signature Size (uint16)</li>
<li>Signature (bytes)</li>
<li>Hops (uint8)</li>
<li>Type (uint8)</li>
<li>Data (bytes)</li>
</ul>
<p>The data should be encrypted with the receipients public key. <br>
The Signature must be the encrypted data signed by the senders private key.
All IPvD protocols must have a type.
Current Types:</p>
<table>
<thead>
<tr>
<th>Protocol</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>IDRP</td>
<td>1</td>
</tr>
<tr>
<td>IDHP</td>
<td>2</td>
</tr>
<tr>
<td>TCP</td>
<td>3</td>
</tr>
<tr>
<td>UDP</td>
<td>4</td>
</tr>
<tr>
<td>PING</td>
<td>5</td>
</tr>
</tbody>
</table>
<h3 id="all-ipvd-packets-should-have-the-ethertype-0xda11">All IPvD packets should have the EtherType 0xDA11</h3>
<br>
<h2 id="types-of-device">Types of Device</h2>
<table>
<thead>
<tr>
<th>Name Used</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>End Device or Device</td>
<td>Generic device should be assumed unless otherwise stated</td>
</tr>
<tr>
<td>NAT-Device</td>
<td>A Device that separates a the internet and a private network</td>
</tr>
<tr>
<td>Semi-Node</td>
<td>An IDRP router that only runs in semi-mode</td>
</tr>
<tr>
<td>Full-Node</td>
<td>An IDRP router that only runs in full-mode</td>
</tr>
</tbody>
</table>
<br>
<h2 id="network-types">Network Types</h2>
<table>
<thead>
<tr>
<th>Network Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Public</td>
<td>A network that every address can be accessable by anyone on the internet</td>
</tr>
<tr>
<td>Private</td>
<td>A network where only the address can be accessed by the other devices on the network*</td>
</tr>
</tbody>
</table>
<p>*Unless otherwise stated in the NAT-device</p>
<br>
<h2 id="routing-and-discovery">Routing and Discovery</h2>
<h3 id="pdp-peer-discovery-protocol">PDP (Peer Discovery Protocol)</h3>
<p>PDP is a Level 2 Protocol</p>
<p>When a client connects to a new network, It should broadcast a PDP packet (details Below) and await a response. Then, the info should be stored for the interface the packet was recieved on.<br></p>
<h4 id="request-packet">Request Packet</h4>
<ul>
<li>Sender Size (uint16)</li>
<li>Sender Address (utf-8)</li>
</ul>
<h4 id="responce-packet">Responce Packet</h4>
<ul>
<li>Return Address Size (uint16)</li>
<li>Return Address (utf-8)</li>
<li>Managed (bool)  [Is this flag is set the following should also be added]
<ul>
<li>Default Route MAC Address (utf-8) (12 Chars)</li>
<li>Main DNS Server Address Size (uint16)</li>
<li>Main DNS Server Address (utf-8)</li>
<li>Alt DNS Server Address Size (uint16)</li>
<li>Alt DNS Server Address (utf-8)</li>
</ul>
</li>
<li>Type (uint8)
<ul>
<li>Should be 1 if the connection is to a end-device</li>
<li>Should be 2 if the connection is to a NAT device</li>
<li>Should be 3 if the connection is to a Semi-Node</li>
<li>Should be 4 if the connection is to a Full-Node</li>
</ul>
</li>
</ul>
<p>Any device that forwards traffic should have a default port to send all unkown traffic.</p>
<p>External ports should never allow a client that has the managed flag set.</p>
<p>Switches should forward PDP packets to the known NAT-Device. If a switch is used externally it should never forward PDP packets but respond as a node according to the node status.</p>
<h3 id="arp-address-resolution-protocol">ARP (Address Resolution Protocol)</h3>
<p>ARP is a level 2 Protocol</p>
<p>ARP should only be used in internal networks. When a client on a internal network does not know an address it should broadcast a ARP packet. This are packet should contain the following:</p>
<ul>
<li>IPvD Address Size (uint16)</li>
<li>IPvD Address (utf-8)</li>
</ul>
<p>The server should respond with:</p>
<ul>
<li>MAC Address (utf-8) (12 Chars)</li>
</ul>
<p>If the NAT-device detects a ARP packet, and none of the requested addresses are on the network the NAT-device runs. It should not respond. If the requested address it not on the network the NAT-device should respond its MAC address. Then, It should relay any packets (that a not for the NAT-Device) to the default route or a applicable routes.</p>
<h3 id="idrp-ipvd-routing-protocol">IDRP (IpvD Routing Protocol)</h3>
<p>IDRP is an IPvD Protocol.</p>
<p>IDRP is the alternative to BGP, There are two types of nodes:</p>
<table>
<thead>
<tr>
<th>Node Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Full Node</td>
<td>This node should save all routes (save the address and next hop.)</td>
</tr>
<tr>
<td>Semi Node</td>
<td>This node should only cache routes for direct peers.</td>
</tr>
</tbody>
</table>
<p>Node behaivor:</p>
<ul>
<li>If a node recieves a packet for an unknown address that node should forward that packet to a trusted node (user defined default route)</li>
<li>If any node receives a route (except from a full node to a semi-node) that route should be relayed to all other full nodes</li>
<li>Semi-nodes should discard all non-direct routes (if the relayed flag is set)</li>
<li>If receiving a route from a node, the recieving node should verify the connection by sending an IDRP ping packet</li>
<li>All IPvD packets should contain a “hops” section the default should be 128. Every node the packet passes through should decrease the value by 1</li>
<li>If a node receives a packet with a hop number of 0, the packet should be discarded.</li>
<li>All packets should have a TTL (Time to live). This value is in seconds, If the difference between the time the route was saved and the current time is longer than the time to live. The route should be deleted a TTL should never exceed 2630000.</li>
<li>Every time a node receives a route it should forward it on to all other nodes. Full nodes should never send routes to semi-nodes. Semi-nodes should send send all routes received to the default node. But semi-node should not cache this info.</li>
</ul>
<p>IDRP Packet IPvD:</p>
<ul>
<li>IPvD Route Address Size (uint16)</li>
<li>IPvD Route Address (utf-8)</li>
<li>MAC Address Hop (utf-8) (12 Chars)</li>
<li>TTL (uint32)</li>
</ul>
<h3 id="ping">Ping</h3>
<p>IDRP is an IPvD Protocol.</p>
<p>Send a ping packet and await a responce.
The random data allows signing of the packet insuring authenticity.</p>
<p>Ping Packet:</p>
<ul>
<li>random 16 byte string (utf-8)</li>
</ul>
<p>Responce:</p>
<ul>
<li>random 16 byte string (utf-8)</li>
</ul>
<br>
<h2 id="connection-initiation">Connection Initiation</h2>
<h3 id="idhp-ipvd-handshake-protocol">IDHP (IpvD Handshake Protocol)</h3>
<p>Before any connection IDHP should be utilised.
IDHP is the only IPvD protocol where messages cannot be encrypted.</p>
<p>IDHP is where the key exchange takes place.</p>
<p>The client should send a IDHP packet containing the clients public key and the server should respond the same. Both of the devices should verify the address and the public key by hashing the public key and verify that last section of the address. The IDHP responce is the same as the orignally sent packet but with the responders public key.</p>
<p>IDHP Packet:</p>
<ul>
<li>Public key Size (uint16)</li>
<li>Public key (utf-8)</li>
</ul>
<br>
<h3 id="tcp-and-udp">TCP and UDP</h3>
<p>TCP and UDP should not deviate from IPv6.</p>
<h2 id="licence-and-modification">Licence and modification</h2>
<pre class="hljs"><code><div>This is free and unencumbered software released into the public domain.

Anyone is free to copy, modify, publish, use, compile, sell, or
distribute this software, either in source code form or as a compiled
binary, for any purpose, commercial or non-commercial, and by any
means.

In jurisdictions that recognize copyright laws, the author or authors
of this software dedicate any and all copyright interest in the
software to the public domain. We make this dedication for the benefit
of the public at large and to the detriment of our heirs and
successors. We intend this dedication to be an overt act of
relinquishment in perpetuity of all present and future rights to this
software under copyright law.

THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
IN NO EVENT SHALL THE AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR
OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.

For more information, please refer to &lt;http://unlicense.org/&gt;
</div></code></pre>

</body>
</html>
